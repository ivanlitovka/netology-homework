**Отчет сканирования дампа оперативной памяти хоста**

**Объекты иследований:** Информация о дампе; список процессов; дерево процессов; загруженные модули и драйвера; открытые порты и сетевые соединения; учетные записи и хэши паролей; файлы, процессы запущенные через коммандную строку.

**Анализ результатов сканирования Volatility**
Общая информация о системе
Операционная система: Windows 7 SP1 (x86)

Время системы: 13:06:28 UTC

Имя компьютера: IEWIN7

**Подозрительные процессы**
SSH-сервер:
Процесс sshd.exe (PID 1740) слушает порты 22 (TCP)
Это нестандартный процесс для Windows системы, может использоваться для удаленного доступа

PowerShell:
Процесс powershell.exe (PID 3672) запущен из cmd.exe
В параметрах присутствует зашифрованный код, который отключает логирование скриптов

Командная строка:
cmd.exe (PID 3008) выполняет скрипт Updater.bat из папки Roaming

Команда: cmd.exe /c C:\Users\Wilfred\AppData\Roaming\Identities\Updater.bat

Нестандартные драйверы:
ad_driver.sys загружен из временного каталога
Путь: C:\Users\Wilfred\AppData\Local\Temp\ad_driver.sys

Подозрительная сетевая активность
Открытые порты:
Порт 22 (SSH) открыт для внешнего подключения
Порт 3389 (RDP) активен
Множество портов svchost.exe в состоянии LISTENING

Подозрительные модули и драйверы
ad_driver.sys:
Загружен в систему
Находится в нестандартном месте
Может использоваться для перехвата системных вызовов

**Вывод о возможной атаке**
На системе обнаружены признаки:

- RAT (Remote Access Trojan) через SSH-сервер

- Выполнение вредоносного кода через PowerShell

- Загрузка нестандартных драйверов

- Потенциальная компрометация через командную строку

**Обнаруженный скрипт powershell**

Cкрипт выполняет несколько действий, связанных с настройкой системы и загрузкой данных. Вот основные шаги:

Проверка версии PowerShell: Скрипт проверяет, установлена ли версия PowerShell 3 или выше. Если да, то он продолжает выполнение.

Отключение журналирования скриптов: Скрипт отключает функции журналирования, такие как EnableScriptBlockLogging и EnableScriptBlockInvocationLogging. Это может быть полезно для скрытия действий, выполняемых в PowerShell.

Создание словаря: Скрипт создает словарь для хранения настроек, связанных с журналированием, и устанавливает значения для отключения журналирования.

Настройка реестра: Скрипт изменяет параметры в реестре, чтобы отключить журналирование на уровне системы.

Загрузка данных: Скрипт загружает данные с указанного URL (http://192.168.1.71:80/news.php) и использует их для выполнения дальнейших действий.

Декодирование данных: Загруженные данные декодируются с использованием алгоритма XOR и ключа, указанного в скрипте.

Выполнение команд: Декодированные данные интерпретируются и выполняются как команды PowerShell.

Этот скрипт может быть использован для обхода систем безопасности и выполнения вредоносных действий.