# Домашнее задание к занятию "Передача маршрутной информации между различными протоколами маршрутизации"

Наша топология:
![image](https://user-images.githubusercontent.com/51816695/154713259-4202c075-9223-441f-bdba-f81895cd6690.png)

### Задание 1. 

На нашей топологии  R4 получает маршруты ( 8.8.4.0/24, 8.8.8.0/24) по протоколу BGP.  
Настроено распределение маршрутов из BGP в OSPF на маршрутизаторе R4. R4 получает маршруты ( 8.8.4.0/24, 8.8.8.0/24).  
- Area 3 - тупиковая ( stub ) зона
- Area 5 - обычная зона
- Area 7 - Totally NSSA зона

1) При помощи какой команды можно настроить импорт маршрутов из BGP в OSPF и на каком маршрутизаторе? Напишите маршрутизатор и команду полностью.

**На R4 необходимо сделать:**   
```
redistribute bgp 4444 metric-type 1 subnets 
```
Будет ли правильно сделать так, чтобы избежать не нужной редистрибьюции из bgp:?
```
ip prefix-list R4-BGP-to-OSPF permit 8.8.4.0/24
ip prefix-list R4-BGP-to-OSPF permit 8.8.8.0/24
route-map R4-FILTER permit 10
    match ip address prefix-list R4-BGP-to-OSPF
    set metric-type type-1
route-map R4-FILTER deny 20 #Как правильно запретить импортировать 
другие маршруты из bgp?
router ospf 1
    redistribute bgp 4444 route-map R4-FILTER
```   

2) Какие типы LSA будут отправлены в каждую из зон (Area 0,3,5,7) для отправки информации о импортированных маршрутах (8.8.4.0/24, 8.8.8.0/24)? Напишите список зон с указанием типов LSA.

*Приведите ответы на вопросы в свободной форме*   

| | | |   
|-|-|-|
| |LSA T4 |Area 0 |
| |LSA T3 |Area 3 |
|Area 0 |LSA T4, T5 |Area 5 |
| |LSA T3 |Area 7 |
| | | |


------

### Задание 2.

На нашей топологии в OSPF импортированы следующие маршруты:
- (8.8.4.0/24, 8.8.8.0/24) из BGP
- 172.16.1.0/24, 172.16.5.0/24 из Area 5 (обычная зона)
- 172.16.1.0/24, 172.16.7.0/24 из Area 7 (Totally NSSA зона)

1) Какой тип зоны необходимо задать для Area 3, чтобы размер LSDB был минимальным? Какие типы LSA будут на маршрутизаторах в Area 3, не учитывая LSA 1 и 2? 

Будем получать LSA 3 с указанием одного только маршрута по умолчанию
Так же в базе есть LSA 5 с информацией о внешних маршрутах ASBR.   

2) Какие внешние маршруты будут установлены в таблицу маршрутизации на маршрутизаторах в Area 3?
   
Картина с маршрутами ospf будет выглядеть так:
```   

R10#show ip route ospf 
O*IA 0.0.0.0/0 [110/65] via 192.168.103.1, 00:06:17, Serial0/1/0
```

*Приведите ответы на вопросы в свободной форме*

------

### Задание 3.

На нашей топологии в OSPF импортированы только следующие маршруты:
- 172.16.1.0/24, 172.16.5.0/24 из Area 5 (обычная зона)
- 172.16.1.0/24, 172.16.7.0/24 из Area 7 (Totally NSSA зона)

Необходимо импортировать только данные маршруты  с метрикой 50 в протокол BGP, чтобы они оказались в таблице на маршрутизаторе R5.

1) Какую команду и на каком маршрутизаторе необходимо использовать для выполнения данной задачи?   

Если не ошибаюсь то эту комманду надо использовать:
```
redistribute ospf 1 metric 50
network 172.16.1.0 mask 255.255.255.0
network 172.16.5.0 mask 255.255.255.0
network 172.16.7.0 mask 255.255.255.0
```
2) С помощью какого параметра и каким образом можно проверить на R5, что данные маршруты импортированы корректно?
   
Не совсем понимаю почему туда попали маршруты между роутерами. Метрику в cpt задать нельзя. Хотел вначале на R4 прописать network 172.16.0.0 mask 255.255.0.0 Но в bgp попал только маршрут для сети 172.16.7.0, так нельзя делать?   

```
R5#show ip bgp 
BGP table version is 23, local router ID is 8.8.8.1
Status codes: s suppressed, d damped, h history, * valid, > best, i - internal,
              r RIB-failure, S Stale
Origin codes: i - IGP, e - EGP, ? - incomplete

   Network          Next Hop            Metric LocPrf Weight Path
*> 8.8.4.0/24        0.0.0.0                  0     0 32768 i
*> 8.8.8.0/24        0.0.0.0                  0     0 32768 i
*> 172.16.1.0/24     192.168.45.1             0     0     0 4444 i
*> 172.16.5.0/24     192.168.45.1             0     0     0 4444 i
*> 172.16.7.0/24     192.168.45.1             0     0     0 4444 ?
*> 192.168.13.0/30   192.168.45.1             0     0     0 4444 ?
*> 192.168.28.0/30   192.168.45.1             0     0     0 4444 ?
*> 192.168.34.0/30   192.168.45.1             0     0     0 4444 ?
*> 192.168.89.0/30   192.168.45.1             0     0     0 4444 ?
```
*Приведите ответы на вопросы в свободной форме*

------

### Задание 4.

На нашей топологии настроены следующие зоны:
- Area 3 - тупиковая (stub) зона
- Area 5 - обычная зона
- Area 7 - Totally NSSA зона

В Area 5 на маршрутизаторе R7 и в Area 7 есть статический маршрут до сети 172.16.1.0/24. Необходимо импортировать данный маршрут в обоих зонах и при этом необходимо учитывать метрику всех линков, которые будут использоваться. 

1) При помощи какой команды на R7 и R9 можно выполнить данную задачу? 

Я прописал следующую комманду:   
```
ip route 172.16.1.0 255.255.255.0 lo1 #Но это не сработало в моем случае, т.к. этот маршурт уже есть он конектед. В реальности там должен быть некст хоп вместо lo0
redistribute static metric 100 metric-type 1 subnets #для помещения статик маршрута в ospf   
```

2) Какие типы LSA в зонах (Area 0, 3, 5, 7) будут использованы для передачи информации об этом маршруте? 

из Ареи 5 в Арея 0 пойдут LSA 3, из Ареи 7 в Арея 0 пойду LSA 7 которые на ABR будут преобразованы в LSA 5, ареа 0 разошлет всем LSA 3 информацию о внешних маршрутах.

Прикладыва cpt
[route_redistribute.pkt (Cpt 8.2.0)](./files/route_redistribute.pkt)